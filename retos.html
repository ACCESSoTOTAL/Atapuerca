<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Retos SQL - Atapuerca Net</title>
  <link rel="stylesheet" href="css/estilos.css" />
</head>
<body>
  <header>
    <h1 class="glow">‚öîÔ∏è RETOS SQL</h1>
    <nav>
      <a href="index.html">Inicio</a>
      <a href="retos.html">Retos</a>
      <a href="sql.html">Consulta SQL</a>
      <a href="descargas.html">Descargas</a>
      <a href="contacto.html">Contacto</a>
    </nav>
  </header>
  <main>
    <h2>üéØ Entrenamientos de la resistencia</h2>
    <p>Completa estos desaf√≠os SQL para entrenar tus habilidades y ganar puntos. Cada reto te acerca m√°s a convertirte en un maestro hacker de datos.</p>
    
    <div id="retos-container">
      <!-- Los retos se cargar√°n aqu√≠ din√°micamente -->
    </div>
    
    <div style="margin-top: 3em; padding: 1.5em; background: var(--bg-light); border-radius: 5px; border-left: 4px solid var(--accent-cyan);">
      <h4 style="margin: 0 0 1em 0; color: var(--accent-cyan);">ÔøΩ Instrucciones:</h4>
      <ol style="margin: 0; padding-left: 1.5em; color: var(--text-secondary);">
        <li>Lee la descripci√≥n del reto</li>
        <li>Si necesitas ayuda, haz clic en "üí° Pista"</li>
        <li>Haz clic en "üöÄ Ir al Terminal" para escribir tu consulta</li>
        <li>El sistema detectar√° autom√°ticamente si has completado el reto</li>
        <li>¬°Gana puntos y desbloquea nuevos desaf√≠os!</li>
      </ol>
    </div>
  </main>
  <footer>
    <p>&copy; 2025 Atapuerca Net</p>
  </footer>
  <script src="js/dataLoader.js"></script>
  <script src="js/retos.js"></script>
  <script>
    // Cargar retos al abrir la p√°gina
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM cargado, intentando cargar retos...');
      
      // Verificar que las funciones existen
      if (typeof cargarRetos === 'function') {
        console.log('Funci√≥n cargarRetos encontrada, ejecutando...');
        try {
          cargarRetos();
        } catch (error) {
          console.error('Error al cargar retos:', error);
          // Mostrar mensaje de error si falla
          const container = document.getElementById('retos-container');
          if (container) {
            container.innerHTML = '<p style="color: var(--accent-orange);">‚ö†Ô∏è Error cargando retos. Por favor, recarga la p√°gina.</p>';
          }
        }
      } else {
        console.log('Funci√≥n cargarRetos no encontrada');
        const container = document.getElementById('retos-container');
        if (container) {
          container.innerHTML = '<p style="color: var(--accent-orange);">‚ö†Ô∏è Sistema de retos no disponible. Por favor, recarga la p√°gina.</p>';
        }
      }
    });
      function obtenerReto(id) {
        // Buscar en todos los niveles
        for (let nivel in retos) {
          const reto = retos[nivel].find(r => r.id === id);
          if (reto) return reto;
        }
        return null;
      }

      function cargarEjemplo(idReto) {
        const reto = obtenerReto(idReto);
        if (reto && reto.ejemploQuery) {
          localStorage.setItem('queryToLoad', reto.ejemploQuery);
          window.location.href = 'sql.html';
        } else {
          alert('No hay ejemplo disponible para este reto.');
        }
      }

      function mostrarPistaSimple(idReto) {
        const pistaDiv = document.getElementById('pista-' + idReto);
        if (pistaDiv) {
          pistaDiv.style.display = pistaDiv.style.display === 'none' ? 'block' : 'none';
        }
      }
    
      function irAlReto(numeroReto) {
        // Ir al terminal SIN cargar la consulta - que sea un verdadero desaf√≠o
        const reto = retos && retos.find(r => r.id === numeroReto);
        if (reto) {
          localStorage.setItem('retoActual', JSON.stringify(reto));
          // NO guardamos la consulta sugerida - el usuario debe resolverlo
          localStorage.removeItem('consultaPendiente'); 
          window.location.href = 'sql.html?reto=true';
        }
      }
  </script>
</body>
</html>